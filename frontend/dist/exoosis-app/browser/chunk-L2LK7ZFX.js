import{J as l,N as p,Tb as d,Yb as b,a as r,h as u,l as g,o as n,w as o,z as s}from"./chunk-JDCDSAQ7.js";var h=class a{constructor(e){this.api=e}loadingSubject=new u(!1);errorSubject=new u(null);loading$=this.loadingSubject.asObservable();error$=this.errorSubject.asObservable();getProducts(e){let t=new d({fromObject:r(r(r(r(r(r(r({},e?.search?{search:e.search}:{}),e?.categoryId?{categoryId:e.categoryId}:{}),e?.brandId?{brandId:e.brandId}:{}),e?.sortBy?{sortBy:e.sortBy}:{}),e?.sortDescending!==void 0?{sortDescending:e.sortDescending}:{}),e?.page?{page:e.page}:{}),e?.pageSize?{pageSize:e.pageSize}:{})});return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.get("/products",t).pipe(n(i=>(i.data??[]).map(c=>this.mapProduct(c))),o(i=>this.handleError(i)),s(()=>this.loadingSubject.next(!1)))}getCatalogProducts(e){let t=new d({fromObject:r(r(r(r(r(r(r({},e?.search?{search:e.search}:{}),e?.categoryId?{categoryId:e.categoryId}:{}),e?.brandId?{brandId:e.brandId}:{}),e?.sortBy?{sortBy:e.sortBy}:{}),e?.sortDescending!==void 0?{sortDescending:e.sortDescending}:{}),e?.page?{page:e.page}:{}),e?.pageSize?{pageSize:e.pageSize}:{})});return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.get("/products",t).pipe(n(i=>i.data??[]),o(i=>this.handleError(i)),s(()=>this.loadingSubject.next(!1)))}getProductById(e){return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.get(`/products/${e}`).pipe(n(t=>this.mapProduct(t.data)),o(t=>this.handleError(t)),s(()=>this.loadingSubject.next(!1)))}searchProducts(e,t){let i=new d({fromObject:r(r(r(r(r(r({q:e},t?.categoryId?{categoryId:t.categoryId}:{}),t?.brandId?{brandId:t.brandId}:{}),t?.sortBy?{sortBy:t.sortBy}:{}),t?.sortDescending!==void 0?{sortDescending:t.sortDescending}:{}),t?.page?{page:t.page}:{}),t?.pageSize?{pageSize:t.pageSize}:{})});return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.get("/products/search",i).pipe(n(c=>(c.data??[]).map(P=>this.mapProduct(P))),o(c=>this.handleError(c)),s(()=>this.loadingSubject.next(!1)))}filterProducts(e){let t=new d({fromObject:r(r(r(r(r(r(r({},e?.search?{search:e.search}:{}),e?.categoryId?{categoryId:e.categoryId}:{}),e?.brandId?{brandId:e.brandId}:{}),e?.sortBy?{sortBy:e.sortBy}:{}),e?.sortDescending!==void 0?{sortDescending:e.sortDescending}:{}),e?.page?{page:e.page}:{}),e?.pageSize?{pageSize:e.pageSize}:{})});return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.get("/products/filter",t).pipe(n(i=>(i.data??[]).map(c=>this.mapProduct(c))),o(i=>this.handleError(i)),s(()=>this.loadingSubject.next(!1)))}getLowStock(e=10){let t=new d({fromObject:{threshold:e}});return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.get("/products/low-stock",t).pipe(n(i=>(i.data??[]).map(c=>this.mapProduct(c))),o(i=>this.handleError(i)),s(()=>this.loadingSubject.next(!1)))}createProduct(e){return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.post("/products",e).pipe(n(t=>this.mapProduct(t.data)),o(t=>this.handleError(t)),s(()=>this.loadingSubject.next(!1)))}updateProduct(e,t){return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.put(`/products/${e}`,t).pipe(n(i=>this.mapProduct(i.data)),o(i=>this.handleError(i)),s(()=>this.loadingSubject.next(!1)))}deleteProduct(e){return this.loadingSubject.next(!0),this.errorSubject.next(null),this.api.delete(`/products/${e}`).pipe(n(t=>t.data),o(t=>this.handleError(t)),s(()=>this.loadingSubject.next(!1)))}mapProduct(e){let t=e.imageUrls?e.imageUrls.split(",").map(i=>i.trim()).find(Boolean)??"":"";return{id:e.id,name:e.name,category:e.categoryName??"",summary:e.description??"",price:e.price,priceUnit:"",brand:e.brandName??"",highlights:[],integrations:[],specs:[],pricingTiers:[],image:t}}handleError(e){let t=e.error?.message||e.message||"Failed to load products.";return this.errorSubject.next(t),g(()=>e)}static \u0275fac=function(t){return new(t||a)(p(b))};static \u0275prov=l({token:a,factory:a.\u0275fac,providedIn:"root"})};export{h as a};
