<ng-container *ngIf="job; else loading">
  <section class="bg-navy-blue text-white py-16 mt-20">
    <div class="page-container flex flex-col md:flex-row md:items-end justify-between gap-8">
      <div class="space-y-4">
        <nav class="flex items-center gap-2 text-slate-400 text-sm mb-6">
          <a class="hover:text-white transition-colors" routerLink="/career">Careers</a>
          <span class="material-symbols-outlined text-xs">chevron_right</span>
          <span class="text-white">{{job.title}}</span>
        </nav>
        <h1 class="text-4xl lg:text-5xl font-bold tracking-tight">{{job.title}}</h1>
        <div class="flex flex-wrap gap-6 text-slate-300">
          <div class="flex items-center gap-2">
            <span class="material-symbols-outlined text-primary">location_on</span>
            <span>{{job.location}}, Bangladesh</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="material-symbols-outlined text-primary">work</span>
            <span>{{job.type}}</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="material-symbols-outlined text-primary">apartment</span>
            <span>{{job.team}}</span>
          </div>
        </div>
      </div>
      <div class="flex items-center gap-4 shrink-0">
        <a href="#application-form" class="bg-primary hover:bg-blue-600 text-white px-8 py-4 rounded-lg font-bold transition-all shadow-lg flex items-center gap-2">
          Apply Now
          <span class="material-symbols-outlined">arrow_right_alt</span>
        </a>
      </div>
    </div>
  </section>

  <main class="page-container py-12 lg:py-20">
    <div class="grid grid-cols-1 lg:grid-cols-12 gap-12 lg:gap-16">
      <div class="lg:col-span-8 space-y-12">
        <section class="prose prose-slate max-w-none">
          <h2 class="text-2xl font-bold text-navy-blue mb-6">About the Role</h2>
          <p class="text-slate-600 leading-relaxed text-lg">{{job.description}}</p>
        </section>

        <section>
          <h2 class="text-2xl font-bold text-navy-blue mb-6">Key Responsibilities</h2>
          <ul class="space-y-4">
            <li *ngFor="let item of job.responsibilities" class="flex items-start gap-4">
              <span class="material-symbols-outlined text-primary mt-0.5">check_circle</span>
              <span class="text-slate-600 text-lg">{{item}}</span>
            </li>
          </ul>
        </section>

        <section>
          <h2 class="text-2xl font-bold text-navy-blue mb-6">Qualifications</h2>
          <ul class="space-y-4">
            <li *ngFor="let req of job.requirements" class="flex items-start gap-4">
              <span class="material-symbols-outlined text-primary mt-0.5">school</span>
              <span class="text-slate-600 text-lg">{{req}}</span>
            </li>
          </ul>
        </section>

        <section id="application-form" class="scroll-mt-24">
          <h2 class="text-2xl font-bold text-navy-blue mb-6">Submit your application</h2>
          <form #applicationForm="ngForm" class="space-y-6" (ngSubmit)="submitApplication()">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <div>
                <label class="text-sm font-semibold text-slate-700">Full name</label>
                <input name="fullName" [(ngModel)]="application.fullName" required class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="Jane Doe">
              </div>
              <div>
                <label class="text-sm font-semibold text-slate-700">Email address</label>
                <input type="email" name="email" [(ngModel)]="application.email" required class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="jane@company.com">
              </div>
              <div>
                <label class="text-sm font-semibold text-slate-700">Phone</label>
                <input name="phone" [(ngModel)]="application.phone" required class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="+880 1234 567890">
              </div>
              <div>
                <label class="text-sm font-semibold text-slate-700">Location</label>
                <input name="location" [(ngModel)]="application.location" required class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="Dhaka, Bangladesh">
              </div>
              <div>
                <label class="text-sm font-semibold text-slate-700">LinkedIn URL</label>
                <input type="url" name="linkedInUrl" [(ngModel)]="application.linkedInUrl" class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="https://linkedin.com/in/yourprofile">
              </div>
              <div>
                <label class="text-sm font-semibold text-slate-700">Portfolio URL</label>
                <input type="url" name="portfolioUrl" [(ngModel)]="application.portfolioUrl" class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="https://portfolio.com">
              </div>
            </div>

            <div>
              <label class="text-sm font-semibold text-slate-700">Resume URL</label>
              <input type="url" name="resumeUrl" [(ngModel)]="application.resumeUrl" required class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="https://drive.google.com/...">
            </div>

            <div>
              <label class="text-sm font-semibold text-slate-700">Cover letter</label>
              <textarea name="coverLetter" [(ngModel)]="application.coverLetter" required rows="4" class="mt-2 w-full px-4 py-3 rounded-lg border border-slate-200 focus:border-primary outline-none" placeholder="Share how your experience aligns with this role."></textarea>
            </div>

            <div class="flex flex-col gap-3">
              <button type="submit" [disabled]="applicationForm.invalid || isSubmitting" class="bg-primary hover:bg-blue-600 disabled:opacity-60 disabled:cursor-not-allowed text-white px-6 py-3 rounded-lg font-semibold transition-all">
                {{ isSubmitting ? 'Submitting...' : 'Submit application' }}
              </button>
              <p *ngIf="submitSuccess" class="text-green-600 font-semibold">Thanks! Your application has been submitted.</p>
              <p *ngIf="submitError" class="text-red-600 font-semibold">{{ submitError }}</p>
            </div>
          </form>
        </section>
      </div>

      <aside class="lg:col-span-4 space-y-8">
        <div class="bg-white border border-slate-200 rounded-2xl overflow-hidden shadow-sm">
          <div class="p-6 bg-slate-50 border-b border-slate-200">
            <h2 class="text-lg font-bold text-navy-blue">Job Summary</h2>
          </div>
          <div class="p-6 space-y-6">
            <div class="flex items-center gap-4">
              <div class="size-10 rounded-lg bg-blue-50 flex items-center justify-center text-primary">
                <span class="material-symbols-outlined">payments</span>
              </div>
              <div>
                <p class="text-xs text-slate-500 font-bold uppercase tracking-wide">Salary Range</p>
                <p class="text-slate-900 font-semibold">{{job.salary}}</p>
              </div>
            </div>
            <div class="flex items-center gap-4">
              <div class="size-10 rounded-lg bg-blue-50 flex items-center justify-center text-primary">
                <span class="material-symbols-outlined">event</span>
              </div>
              <div>
                <p class="text-xs text-slate-500 font-bold uppercase tracking-wide">Date Posted</p>
                <p class="text-slate-900 font-semibold">{{job.datePosted}}</p>
              </div>
            </div>
          </div>
        </div>
      </aside>
    </div>
  </main>
</ng-container>

<ng-template #loading>
  <div class="min-h-screen flex items-center justify-center">
    <div class="animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"></div>
  </div>
</ng-template>
